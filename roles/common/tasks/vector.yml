---
- name: common | Install Vector Datadog Keys
  ansible.builtin.apt_key:
    url: "{{ item }}"
    state: present
    keyring: "/usr/share/keyrings/datadog-archive-keyring.gpg"
  loop:
    - "https://keys.datadoghq.com/DATADOG_APT_KEY_CURRENT.public"
    - "https://keys.datadoghq.com/DATADOG_APT_KEY_F14F620E.public"
    - "https://keys.datadoghq.com/DATADOG_APT_KEY_C0962C7D.public"
  when:
    - ansible_os_family == "Debian"

- name: common | Install Vector Datadog Repo
  ansible.builtin.apt_repository:
    repo: "deb [signed-by=/usr/share/keyrings/datadog-archive-keyring.gpg] https://apt.vector.dev/ stable vector-0"
    filename: "vector"
  when:
    - ansible_os_family == "Debian"

- name: common | install vector
  ansible.builtin.apt:
    name: vector
    update_cache: true
  when:
    - ansible_os_family == "Debian"
