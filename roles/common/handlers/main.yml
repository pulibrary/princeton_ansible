---
# handlers file for roles/common

- name: restart chrony
  ansible.builtin.service:
    name: "{{ chrony_service_name }}"
    state: restarted
  when: running_on_server

- name: test logrotate configuration
  ansible.builtin.command: logrotate -f /etc/logrotate.conf
  register: logrotate_test
  failed_when: logrotate_test.rc != 0
  when:
    - running_on_server

- name: reload logrotate timer settings
  ansible.builtin.systemd:
    daemon_reload: true
    name: logrotate.timer
    enabled: true

- name: restart journald
  ansible.builtin.systemd:
    name: systemd-journald
    state: restarted
  when:
    - running_on_server
