---
- name: Verify
  hosts: all
  gather_facts: false
  tasks:
    - name: Test logrotate syntax
      ansible.builtin.command: logrotate -d /etc/logrotate.conf
      register: syntax_test
      changed_when: false
      failed_when: syntax_test.rc != 0

    - name: Check basic role files
      ansible.builtin.stat:
        path: "{{ item }}"
      register: role_files
      loop:
        - /etc/tmux.conf
        - /etc/vim/vimrc.local

    - name: Verify role files exist
      ansible.builtin.assert:
        that:
          - item.stat.exists
        fail_msg: "File {{ item.item }} was not created"
      loop: "{{ role_files.results }}"
