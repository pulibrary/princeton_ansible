---
- name: ojs | install php postgres drivers
  apt:
    name: ['libapache2-mod-php', 'php{{ php_version }}-pgsql', 'php{{ php_version }}-mbstring', 'php{{ php_version }}-ldap', 'php{{ php_version }}-xml']
    state: present

- name: ojs | create ojs directory
  file:
    path: "{{ ojs_home }}"
    state: directory
    owner: "www-data"
    group: "www-data"
    mode: 0755

- name: ojs | remove apache document root
  file:
    path: "{{ apache.docroot }}"
    state: absent
  changed_when: false

- name: ojs | install node environment settings
  template:
    src: env_file.j2
    dest: "{{ ojs_home }}/.env.production"
    mode: 0644
  changed_when: false

- name: ojs | create hidden env file
  file:
    src: "{{ ojs_home }}/.env.production"
    dest: "{{ ojs_home }}/.env"
    state: link
