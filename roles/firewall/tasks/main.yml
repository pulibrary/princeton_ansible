---
# tasks file for roles/ufw_firewall
- name: Firewall | Determine OS family
  ansible.builtin.set_fact:
    os_family: "{{ ansible_os_family }}"

- name: Firewall | Install UFW
  ansible.builtin.package:
    name: ufw
    state: present

- name: Firewall | Enable UFW
  community.general.ufw:
    state: enabled

- name: Firewall | generic rules
  ansible.builtin.include_tasks: rules.yml
  loop: "{{ firewall_rules }}"
  loop_control:
    loop_var: rule

- name: Firewall | Deny all other incoming traffic (UFW)
  community.general.ufw:
    rule: deny
    direction: in
