---
- name: Zookeeper | Create myid directory
  ansible.builtin.file:
    path: "{{ zookeeper_data_dir }}/{{ item.zookeeper_hosts_dict }}"
    state: directory
    mode: "0755"
    owner: '{{ zookeeper_user }}'
    group: '{{ zookeeper_group }}'
  loop:
    - server.id

- name: Zookeeper | Overwrite myid file.
  ansible.builtin.template:
    src: 'myid.j2'
    dest: '{{ zookeeper_data_dir }}/{{ zookeeper_hosts_dict }}/myid'
    mode: 0644
    force: '{{ zookeeper_force_myid }}'
    owner: '{{ zookeeper_user }}'
    group: '{{ zookeeper_group }}'
  notify:
    - Restart zookeeper

- name: Zookeeper | Overwrite application default config file
  ansible.builtin.template:
    src: 'zoo.cfg.j2'
    dest: '{{ zookeeper_conf_dir }}/conf/zoo.cfg'
    mode: 0644
    owner: '{{ zookeeper_user }}'
    group: '{{ zookeeper_group }}'
  notify:
    - Restart zookeeper

- name: Zookeeper | Configure zookeeper-env.sh
  ansible.builtin.template:
    src: 'zookeeper-env.sh.j2'
    dest: '{{ zookeeper_conf_dir }}/conf/zookeeper-env.sh'
    mode: 0644
    owner: '{{ zookeeper_user }}'
    group: '{{ zookeeper_group }}'
  notify:
    - Restart zookeeper

- name: Zookeeper | Update the log4j
  ansible.builtin.template:
    src: 'log4j.properties.j2'
    dest: '{{ zookeeper_conf_dir }}/conf/log4j.properties'
    owner: '{{ zookeeper_user }}'
    group: '{{ zookeeper_group }}'
    mode: 0644
  notify:
    - Restart zookeeper
