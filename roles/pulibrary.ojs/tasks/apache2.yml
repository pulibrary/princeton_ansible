---
- name: ojs | set ojs Virtualhost
  template:
    src: virtualhost.conf.j2
    dest: "/etc/apache2/sites-available/{{ deploy_ojs_url }}.conf"
  changed_when: false

- name: ojs | activate ojs virtualhost
  command: a2ensite 000-default
  changed_when: false

- name: ojs | activate ojs virtualhost
  command: a2ensite "{{ deploy_ojs_url }}"
  changed_when: false
  notify:
    - restart apache

- name: ojs | set apache Virtualhost
  template:
    src: templates/htaccess
    dest: "{{ deploy_ojs_dest }}/.htaccess"
  changed_when: false

- name: htaccess in config.inc.php
  lineinfile:
    path: "{{ deploy_ojs_dest }}/config.inc.php"
    regexp: "^restful_urls"
    line: "restful_urls = On"
  changed_when: false
