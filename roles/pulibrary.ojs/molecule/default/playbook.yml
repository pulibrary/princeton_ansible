---
- name: Converge
  hosts: all
  vars:
    - running_on_server: false
  roles:
    - role: pulibrary.ojs
      postgresql_databases:
        - name: ojs_db
      postgresql_users:
        - name: ojs_db_user
          password: "change_me"
          db: ojs_db
          priv: "ALL"
          role_attr_flags: "SUPERUSER,INHERIT,NOCREATEDB,NOCREATEROLE,NOREPLICATION"
      postgresql_hba_entries:
        - type: local
          database: all
          user: postgres
          method: ident
        - type: host
          database: all
          user: postgres
          address: 127.0.0.1/32
          method: ident
        - type: host
          database: ojs_db
          user: ojs_db_user
          address: 127.0.0.1/32
          method: md5
