---
- name: install software properties
  apt:
    name: software-properties-common
    state: latest

- name: add mariadb repo keys
  apt_key:
    keyserver: 'keyserver.ubuntu.com'
    id: '{{ item }}'
  with_items: '{{ mariadb_apt_gpg_keys }}'

- name: add maria db repository
  apt_repository:
    repo: 'deb [arch=amd64,i386,ppc64el] {{ mariadb_apt_mirror_base }}/{{ mariadb_version }}/{{ ansible_distribution|lower }}/ {{ ansible_distribution_release }} main'

- name: install maria db version
  apt:
    name: '{{ item }}'
    state: present
    update_cache: yes
  with_items:
    - python-mysqldb
    - mariadb-server

- import_tasks: mysql_users.yml
  tags: mysql-users
  when: mariadb_mysql_users is defined

- import_tasks: root_access.yml
