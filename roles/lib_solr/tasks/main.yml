---
- name: lib_solr | Install cifs-utils
  ansible.builtin.apt:
    name: ["cifs-utils"]
    state: present

- name: lib_solr | Create mount directories
  ansible.builtin.file:
    path: '/mnt/solr_backup'
    state: 'directory'
    mode: 0755

- name: lib_solr | Copy smb credentials
  ansible.builtin.copy:
    src: "files/{{ item }}"
    dest: "/etc/{{ item }}"
    mode: 0644
  when: running_on_server
  with_items:
    - solr.smb.credentials

- name: lib_solr | Create mount to solrbackup
  ansible.posix.mount:
    name: /mnt/solr_backup
    src: //diglibdata1.princeton.edu/solrbackup
    fstype: cifs
    opts: 'credentials=/etc/solr.smb.credentials,uid={{ deploy_user_uid }}'
    state: mounted
  when: running_on_server
