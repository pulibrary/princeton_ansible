#%PAM-1.0
auth [success=done default=die] pam_himmelblau.so ignore_unknown_user mfa_poll_prompt socket=/var/run/himmelblaud/socket upn_domain=princeton.edu
auth        required                    pam_env.so
auth        required                    pam_faillock.so preauth silent deny=3 unlock_time=900
auth        sufficient                  pam_unix.so nullok try_first_pass
auth        sufficient                  pam_sss.so use_first_pass
auth        [default=die]               pam_faillock.so authfail deny=3 unlock_time=900
auth        required                    pam_deny.so

account     [success=done default=ignore] pam_himmelblau.so ignore_unknown_user
account     required                    pam_unix.so
account     sufficient                  pam_localuser.so
account     sufficient                  pam_succeed_if.so uid < 1000 quiet
account     [default=bad success=ok user_unknown=ignore] pam_sss.so
account     required                    pam_permit.so

password    [success=4 default=ignore]  pam_himmelblau.so ignore_unknown_user
password    requisite                   pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=
password    sufficient                  pam_unix.so sha512 shadow nullok try_first_pass use_authtok
password    sufficient                  pam_sss.so use_authtok
password    required                    pam_deny.so

session     optional                    pam_himmelblau.so
session     required                    pam_limits.so
session     optional                    pam_systemd.so
session     required                    pam_unix.so
session     required                    pam_mkhomedir.so skel=/etc/skel umask=0027
