---
- name: Verify
  hosts: all
  gather_facts: false
  tasks:
  - name: test for mflux path existence
    ansible.builtin.stat:
      path: "{{ item }}"
    loop:
      - "/opt/mediaflux"
    register: file
    failed_when:
      - not file.stat.exists
  - name: check for mediaflux dependency software
    ansible.builtin.package:
      name: "{{ item }}"
      state: present
    check_mode: true
    register: pkg_status
    loop:
      - curl
      - vim
      - git
      - java-1.8.0-openjdk
      - wget
      - expect
      - python3-pexpect
      - python3-psycopg2
  - name: test for mediaflux packages
    ansible.builtin.assert:
      that:
        - not pkg_status.changed
