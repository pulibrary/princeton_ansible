---
# defaults file for roles/pulibrary.postgresql
postgresql_version: 11
postgresql_apt_key_url: "https://www.postgresql.org/media/keys/ACCC4CF8.asc"
postgres_settings:
  - name: port
    value: 5432
  - name: listen_addresses
    value: 127.0.0.1
  - name: unix_socket_directories
    value: /var/run/postgresql
  - name: max_wal_size
    value: 1GB
  - name: min_wal_size
    value: 80MB
  - name: log_timezone
    value: UCT
  - name: datestyle
    value: iso, ymd
  - name: timezone
    value: UCT
  - name: default_text_search_config
    value: pg_catalog.english

postgres_hba_entries:
  - type: local
    database: all
    user: all
    method: peer
  - type: host
    database: all
    user: all
    address: 127.0.0.1/32
    method: ident
  - type: host
    database: all
    user: all
    address: ::1/128
    method: ident
  - type: local
    database: replication
    user: all
    method: peer
  - type: host
    database: replication
    user: all
    address: 127.0.0.1/32
    method: ident
  - type: host
    database: replication
    user: all
    address: ::1/128
    method: ident

# Extensions
postgresql_ext_install_contrib: false
postgresql_ext_install_dev_headers: false
postgresql_ext_install_postgis: false

postgresql_ext_postgis_version: "3" # be careful: check whether the postgresql/postgis versions work together

postgresql_ext_postgis_deps:
  - libgeos-3.7.1
  - libgeos-c1v5
  - "postgresql-{{ postgresql_version }}-pgrouting"
  - "postgresql-{{ postgresql_version }}-postgis-{{ postgresql_ext_postgis_version }}"
  - "postgresql-{{ postgresql_version }}-postgis-{{ postgresql_ext_postgis_version }}-scripts"
