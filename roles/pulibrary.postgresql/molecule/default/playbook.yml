---
- name: Converge
  hosts: all
  roles:
    - role: pulibrary.postgresql
      postgresql_ext_install_postgis: true
      postgresql_databases:
        - name: awesome_db
          gis: true
      postgresql_database_extensions:
        - db: awesome_db
          extensions:
          - gis
      postgresql_users:
        - name: awesome_user_with_pass
          password: "ToughToGusspAsSwOrD"
        - name: awesome_user_with_db
          password: "ToughToGusspAsSwOrD"
          db: test_db
      postgresql_hba_entries:
        - type: local
          database: all
          user: all
          method: peer
        - type: host
          database: all
          user: all
          address: 127.0.0.1/32
          method: ident
        - type: host
          database: all
          user: all
          address: ::1/128
          method: ident
        - type: local
          database: replication
          user: all
          method: peer
        - type: host
          database: replication
          user: all
          address: 127.0.0.1/32
          method: ident
        - type: host
          database: replication
          user: all
          address: ::1/128
          method: ident
