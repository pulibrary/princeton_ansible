---
- name: erlang | Get erlang-solutions APT GPG key
  apt_key:
    url: https://packages.erlang-solutions.com/ubuntu/erlang_solutions.asc
    state: present
  register: debsource_servers
  ignore_errors: true

- name: Add upstream erlang APT repository
  apt_repository:
    repo: "deb https://packages.erlang-solutions.com/ubuntu {{ ansible_lsb.codename }} contrib"
    state: present
    update_cache: true
  register: erlang_repo
  retries: 3
  delay: 60
  until: erlang_repo is succeeded

- name: Install erlang
  apt:
    name: "esl-erlang={{ erlang_version }}"
    state: present

- name: Install elixir
  apt:
    name: "elixir={{ elixir_version }}"
    state: present
