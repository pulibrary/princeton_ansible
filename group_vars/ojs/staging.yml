---
ojs_version: "3.2.0-3"
apache:
  docroot: "/var/www/ojs"
  servername: "{{ ansible_hostname }}"
  directory_options: ''

server:
  timezone: "America/New_York"

pgbouncer_database_aliases:
  - name: ojs_db
    host: 127.0.0.1
    dbname: ojs_db
    pool_size: 50
    user: ojs_db_user
pgbouncer_auth_users:
  - name: ojs_db_user
    password: "{{ vault_ojs_pgbouncer_password }}"
pgbouncer_install_pg_client: true
pgbouncer_auth_type: md5
deploy_ojs_database:
  driver: "postgresql"
  host: "{{ ojs_db_host }}"
  username: ojs_db_user
  password: "{{ ojs_db_password }}"
  name: ojs_db

deploy_ojs_smtp:
  server: "ssl://smtp.example.edu"
  port: 25

deploy_ojs_use_catcha: false

deploy_ojs_dest: "{{ ojs_home }}"
deploy_ojs_url: "{{ ansible_hostname }}"
deploy_ojs_files: "{{ ojs_file_uploads }}"
deploy_ojs_new_installation: true
deploy_ojs_user: "{{ ojs_site_adminname }}"
deploy_ojs_password: "{{ ojs_site_adminpassword }}"
deploy_ojs_email: "{{ ojs_site_email }}"
deploy_ojs_locale: 'en_US'
deploy_ojs_protocol: http

ojs_file_uploads: "/var/local/files"
ojs_home: "/var/www/ojs-{{ ojs_version }}"
postgresql_databases:
  - name: ojs_db
postgresql_users:
  - name: ojs_db_user
    password: "{{ ojs_db_password }}"
    db: ojs_db
    priv: "ALL"
    role_attr_flags: "SUPERUSER,INHERIT,NOCREATEDB,NOCREATEROLE,NOREPLICATION"
postgresql_hba_entries:
  - type: local
    database: all
    user: postgres
    method: ident
  - type: local
    database: replicant
    user: replicant
    method: md5
  - type: host
    database: all
    user: postgres
    address: 127.0.0.1/32
    method: ident
  - type: host
    database: replication
    user: replicant
    address: "{{ master_db_ip }}/32"
    method: md5
  - type: host
    database: replication
    user: replicant
    address: "{{ standby_db_ip }}/32"
    method: md5
  - type: host
    database: replicant
    user: replicant
    address: 127.0.0.1/32
    method: md5
  - type: host
    database: replicant
    user: replicant
    address: "{{ master_db_ip }}/32"
    method: md5
  - type: host
    database: replicant
    user: replicant
    address: "{{ standby_db_ip }}/32"
    method: md5
  - type: host
    database: all
    user: pgbouncer_user
    address: "{{ standby_db_ip }}/32"
    method: md5
  - type: host
    database: ojs_db
    user: ojs_db_user
    address: 128.112.203.126/32
    method: md5
postgres_version: "12"
ojs_site_email: "{{ vault_ojs_site_email }}"
ojs_site_adminname: "{{ vault_ojs_site_adminname }}"
ojs_site_adminpassword: "{{ vault_ojs_site_adminpassword }}"
ojs_db_password: "{{ vault_ojs_db_password }}"
ojs_site_repoid: "pul_ojs_staging"
ojs_db_host: "{{ db_host }}"
application_dbuser_name: "ojs_db_user"
application_dbuser_password: "{{ ojs_db_password }}"
application_db_name: "ojs_db"
db_host: lib-postgres-staging1.princeton.edu
