---
figgy_tags: "application:figgy, environment:production, type:webserver"
figgy_datadog_http_check:
  init_config:
  instances:
    - name: Solr Health
      url: 'http://localhost/health.json'
      content_match: '{"name":"SolrStatus","message":"","status":"OK"}'
      include_content: true
      tags:
        - 'http_service:figgy'
        - 'http_service_type:health'
        - 'http_service_check:solr'
    - name: Database Health
      url: 'http://localhost/health.json'
      content_match: '{"name":"Database","message":"","status":"OK"}'
      include_content: true
      tags:
        - 'http_service:figgy'
        - 'http_service_type:health'
        - 'http_service_check:postgres'
    - name: Redis Health
      url: 'http://localhost/health.json'
      content_match: '{"name":"Redis","message":"","status":"OK"}'
      include_content: true
      tags:
        - 'http_service:figgy'
        - 'http_service_type:health'
        - 'http_service_check:redis'
    - name: ASpace Health
      url: 'http://localhost/health.json'
      content_match: '{"name":"AspaceStatus","message":"","status":"OK"}'
      include_content: true
      tags:
        - 'http_service:figgy'
        - 'http_service_type:health'
        - 'http_service_check:aspace'
figgy_datadog_nginx_check:
  init_config:
  logs:
    - type: file
      path: /var/log/nginx/access.log
      service: figgy
      source: nginx
      sourcecategory: http_web_access
    - type: file
      path: /var/log/nginx/error.log
      service: figgy
      source: nginx
      sourcecategory: http_web_access
datadog_checks:
  nginx:
    '{{ figgy_datadog_nginx_check }}'
  ruby:
    '{{ figgy_datadog_ruby_check }}'
  http_check:
    '{{ figgy_datadog_http_check }}'
  tls_check:
    '{{ figgy_datadog_tls_check }}'
