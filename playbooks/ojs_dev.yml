---
- hosts: gcp_ojs_dev
  remote_user: pulsys
  become: true
  gather_facts: false
  vars:
    - post_install: |
        Possible Things left to do:
        - run a cap for ojs
  vars_files:
    - ../group_vars/gcp/dev.yml
    - ../group_vars/ojs/dev.yml
    - ../group_vars/ojs/vault.yml
  pre_tasks:
    - name: install python when unavailable
      raw: test -e /usr/bin/python || (apt -y update && apt install -y python-minimal)
  roles:
    - role: ../roles/ojs
  post_tasks:
    - name: tell everyone on slack you ran an ansible playbook
      slack:
        token: "{{ vault_pul_slack_token }}"
        msg: "{{ inventory_hostname }} completed"
        channel: #server-alerts

    - name: post role reminders
      debug:
        msg: "{{ post_install.split('\n') }}"
