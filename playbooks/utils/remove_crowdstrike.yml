---
#  This playbook will uninstall crowdstrike 
#     
- name: remove falcon on a host
  hosts: staging:qa:production
  remote_user: pulsys
  become: true

  tasks:

    - name: Uninstall crowdstrike (ubuntu)
      ansible.builtin.apt:
        name: falcon-sensor
        state: absent
      when:
        - ansible_os_family == "Debian"

    - name: Uninstall crowdstrike (RHEL/Rocky)
      ansible.builtin.dnf:
        name: falcon-sensor
        state: absent
      when:
        - ansible_os_family == "RedHat"

    - name: Wipe out directory for crowdstrike
      ansible.builtin.file:
        path: "/opt/CrowdStrike"
        state: absent


  # post_tasks:
    # - name: send information to slack
      # ansible.builtin.include_tasks:
        # file: slack_tasks_end_of_playbook.yml
