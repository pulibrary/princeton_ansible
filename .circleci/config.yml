 version: 2.1
 jobs:
   test_role:
     working_directory: ~/princeton_ansible
     docker:
       - image: quay.io/ansible/molecule:2.22rc3
     parameters:
       role:
         type: string
     steps:
       - checkout
       - setup_remote_docker
       - run: 
          name: Run molecule test for rails app role
          command: |
            cd roles/<< parameters.role >>/
            molecule test
 workflows:
   ci:
     jobs:
       - test_role:
           name: "test_deploy-user"
           role: "pulibrary.deploy-user"
       - test_role:
           name: "test_rails-app"
           role: "pulibrary.rails-app"
       - test_role:
           name: "test_approvals"
           role: "pulibrary.approvals"
